{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/ernie2506/MMA/blob/main/Classfication_On_Default_Payment\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "xvoJHY3fHW5z"
      },
      "source": [
        "# MMA 823: Team Project\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "oGmS4d9bHc38"
      },
      "source": [
        "\n",
        "\n",
        "*  Team Parliament\n",
        "*  Section 2\n",
        "*November 2, 2021\n",
        "\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "M8LCGPW5Ohtl"
      },
      "source": [
        "Install packages "
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Z-XO14EyOjjE",
        "outputId": "de144857-379a-43c4-9cc2-179f5342ab0a"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Collecting pandas-profiling==2.7.1\n",
            "  Using cached pandas_profiling-2.7.1-py2.py3-none-any.whl (252 kB)\n",
            "Requirement already satisfied: matplotlib>=3.2.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (3.3.4)\n",
            "Requirement already satisfied: phik>=0.9.10 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (0.12.0)\n",
            "Requirement already satisfied: joblib in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (1.0.1)\n",
            "Collecting visions[type_image_path]==0.4.1\n",
            "  Using cached visions-0.4.1-py3-none-any.whl (58 kB)\n",
            "Requirement already satisfied: astropy>=4.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (4.2.1)\n",
            "Requirement already satisfied: tqdm>=4.43.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (4.59.0)\n",
            "Requirement already satisfied: tangled-up-in-unicode>=0.0.4 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (0.1.0)\n",
            "Requirement already satisfied: ipywidgets>=7.5.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (7.6.3)\n",
            "Requirement already satisfied: pandas!=1.0.0,!=1.0.1,!=1.0.2,>=0.25.3 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (1.2.4)\n",
            "Requirement already satisfied: htmlmin>=0.1.12 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (0.1.12)\n",
            "Requirement already satisfied: missingno>=0.4.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (0.5.0)\n",
            "Requirement already satisfied: requests>=2.23.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (2.25.1)\n",
            "Requirement already satisfied: scipy>=1.4.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (1.5.4)\n",
            "Requirement already satisfied: confuse>=1.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (1.6.0)\n",
            "Requirement already satisfied: numpy>=1.16.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (1.19.5)\n",
            "Requirement already satisfied: jinja2>=2.11.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling==2.7.1) (2.11.3)\n",
            "Requirement already satisfied: attrs>=19.3.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from visions[type_image_path]==0.4.1->pandas-profiling==2.7.1) (20.3.0)\n",
            "Requirement already satisfied: networkx>=2.4 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from visions[type_image_path]==0.4.1->pandas-profiling==2.7.1) (2.5)\n",
            "Requirement already satisfied: Pillow in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from visions[type_image_path]==0.4.1->pandas-profiling==2.7.1) (8.2.0)\n",
            "Requirement already satisfied: imagehash in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from visions[type_image_path]==0.4.1->pandas-profiling==2.7.1) (4.2.1)\n",
            "Requirement already satisfied: pyerfa in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from astropy>=4.0->pandas-profiling==2.7.1) (1.7.3)\n",
            "Requirement already satisfied: pyyaml in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from confuse>=1.0.0->pandas-profiling==2.7.1) (5.4.1)\n",
            "Requirement already satisfied: traitlets>=4.3.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipywidgets>=7.5.1->pandas-profiling==2.7.1) (5.0.5)\n",
            "Requirement already satisfied: nbformat>=4.2.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipywidgets>=7.5.1->pandas-profiling==2.7.1) (5.1.3)\n",
            "Requirement already satisfied: ipykernel>=4.5.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipywidgets>=7.5.1->pandas-profiling==2.7.1) (5.3.4)\n",
            "Requirement already satisfied: widgetsnbextension~=3.5.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipywidgets>=7.5.1->pandas-profiling==2.7.1) (3.5.1)\n",
            "Requirement already satisfied: ipython>=4.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipywidgets>=7.5.1->pandas-profiling==2.7.1) (7.22.0)\n",
            "Requirement already satisfied: jupyterlab-widgets>=1.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipywidgets>=7.5.1->pandas-profiling==2.7.1) (1.0.0)\n",
            "Requirement already satisfied: tornado>=4.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipykernel>=4.5.1->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (6.1)\n",
            "Requirement already satisfied: jupyter-client in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipykernel>=4.5.1->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (6.1.12)\n",
            "Requirement already satisfied: jedi>=0.16 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipython>=4.0.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.17.2)\n",
            "Requirement already satisfied: colorama in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipython>=4.0.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.4.4)\n",
            "Requirement already satisfied: pygments in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipython>=4.0.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (2.8.1)\n",
            "Requirement already satisfied: setuptools>=18.5 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipython>=4.0.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (52.0.0.post20210125)\n",
            "Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipython>=4.0.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (3.0.17)\n",
            "Requirement already satisfied: backcall in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipython>=4.0.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.2.0)\n",
            "Requirement already satisfied: decorator in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipython>=4.0.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (5.0.6)\n",
            "Requirement already satisfied: pickleshare in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipython>=4.0.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.7.5)\n",
            "Requirement already satisfied: parso<0.8.0,>=0.7.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from jedi>=0.16->ipython>=4.0.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.7.0)\n",
            "Requirement already satisfied: MarkupSafe>=0.23 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from jinja2>=2.11.1->pandas-profiling==2.7.1) (2.0.1)\n",
            "Requirement already satisfied: kiwisolver>=1.0.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from matplotlib>=3.2.0->pandas-profiling==2.7.1) (1.3.1)\n",
            "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.3 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from matplotlib>=3.2.0->pandas-profiling==2.7.1) (2.4.7)\n",
            "Requirement already satisfied: python-dateutil>=2.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from matplotlib>=3.2.0->pandas-profiling==2.7.1) (2.8.1)\n",
            "Requirement already satisfied: cycler>=0.10 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from matplotlib>=3.2.0->pandas-profiling==2.7.1) (0.10.0)\n",
            "Requirement already satisfied: six in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from cycler>=0.10->matplotlib>=3.2.0->pandas-profiling==2.7.1) (1.15.0)\n",
            "Requirement already satisfied: seaborn in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from missingno>=0.4.2->pandas-profiling==2.7.1) (0.11.1)\n",
            "Requirement already satisfied: jsonschema!=2.5.0,>=2.4 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbformat>=4.2.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (3.2.0)\n",
            "Requirement already satisfied: jupyter-core in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbformat>=4.2.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (4.7.1)\n",
            "Requirement already satisfied: ipython-genutils in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbformat>=4.2.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.2.0)\n",
            "Requirement already satisfied: pyrsistent>=0.14.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from jsonschema!=2.5.0,>=2.4->nbformat>=4.2.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.17.3)\n",
            "Requirement already satisfied: pytz>=2017.3 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas!=1.0.0,!=1.0.1,!=1.0.2,>=0.25.3->pandas-profiling==2.7.1) (2021.1)\n",
            "Requirement already satisfied: wcwidth in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0->ipython>=4.0.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.2.5)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from requests>=2.23.0->pandas-profiling==2.7.1) (2020.12.5)\n",
            "Requirement already satisfied: urllib3<1.27,>=1.21.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from requests>=2.23.0->pandas-profiling==2.7.1) (1.26.4)\n",
            "Requirement already satisfied: chardet<5,>=3.0.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from requests>=2.23.0->pandas-profiling==2.7.1) (4.0.0)\n",
            "Requirement already satisfied: idna<3,>=2.5 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from requests>=2.23.0->pandas-profiling==2.7.1) (2.10)\n",
            "Requirement already satisfied: notebook>=4.4.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (6.3.0)\n",
            "Requirement already satisfied: terminado>=0.8.3 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.9.4)\n",
            "Requirement already satisfied: nbconvert in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (6.0.7)\n",
            "Requirement already satisfied: pyzmq>=17 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (20.0.0)\n",
            "Requirement already satisfied: Send2Trash>=1.5.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (1.5.0)\n",
            "Requirement already satisfied: argon2-cffi in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (20.1.0)\n",
            "Requirement already satisfied: prometheus-client in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.10.1)\n",
            "Requirement already satisfied: pywin32>=1.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from jupyter-core->nbformat>=4.2.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (227)\n",
            "Requirement already satisfied: pywinpty>=0.5 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from terminado>=0.8.3->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.5.7)\n",
            "Requirement already satisfied: cffi>=1.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from argon2-cffi->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (1.14.5)\n",
            "Requirement already satisfied: pycparser in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from cffi>=1.0.0->argon2-cffi->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (2.20)\n",
            "Requirement already satisfied: PyWavelets in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from imagehash->visions[type_image_path]==0.4.1->pandas-profiling==2.7.1) (1.1.1)\n",
            "Requirement already satisfied: bleach in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (3.3.0)\n",
            "Requirement already satisfied: jupyterlab-pygments in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.1.2)\n",
            "Requirement already satisfied: nbclient<0.6.0,>=0.5.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.5.3)\n",
            "Requirement already satisfied: entrypoints>=0.2.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.3)\n",
            "Requirement already satisfied: mistune<2,>=0.8.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.8.4)\n",
            "Requirement already satisfied: testpath in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.4.4)"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
            "pycaret 2.3.4 requires pandas-profiling>=2.8.0, but you have pandas-profiling 2.7.1 which is incompatible.\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\n",
            "Requirement already satisfied: defusedxml in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.7.1)\n",
            "Requirement already satisfied: pandocfilters>=1.4.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (1.4.3)\n",
            "Requirement already satisfied: async-generator in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbclient<0.6.0,>=0.5.0->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (1.10)\n",
            "Requirement already satisfied: nest-asyncio in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbclient<0.6.0,>=0.5.0->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (1.5.1)\n",
            "Requirement already satisfied: webencodings in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from bleach->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (0.5.1)\n",
            "Requirement already satisfied: packaging in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from bleach->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets>=7.5.1->pandas-profiling==2.7.1) (20.9)\n",
            "Installing collected packages: visions, pandas-profiling\n",
            "  Attempting uninstall: visions\n",
            "    Found existing installation: visions 0.7.4\n",
            "    Uninstalling visions-0.7.4:\n",
            "      Successfully uninstalled visions-0.7.4\n",
            "  Attempting uninstall: pandas-profiling\n",
            "    Found existing installation: pandas-profiling 3.1.0\n",
            "    Uninstalling pandas-profiling-3.1.0:\n",
            "      Successfully uninstalled pandas-profiling-3.1.0\n",
            "Successfully installed pandas-profiling-2.7.1 visions-0.4.1\n"
          ]
        }
      ],
      "source": [
        "!pip install pandas-profiling==2.7.1"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "SDgG4yomRE0a",
        "outputId": "c21cbcaa-dd66-4f3d-a57e-74b15200377d"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Requirement already satisfied: pycaret in e:\\users\\jianz\\anaconda3\\lib\\site-packages (2.3.4)\n",
            "Requirement already satisfied: umap-learn in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.5.1)\n",
            "Requirement already satisfied: mlflow in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (1.20.2)\n",
            "Requirement already satisfied: pandas in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (1.2.4)\n",
            "Requirement already satisfied: Boruta in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.3)\n",
            "Requirement already satisfied: spacy<2.4.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (2.3.7)\n",
            "Requirement already satisfied: numba<0.54 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.53.1)\n",
            "Requirement already satisfied: imbalanced-learn==0.7.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.7.0)\n",
            "Requirement already satisfied: textblob in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.17.1)\n",
            "Requirement already satisfied: lightgbm>=2.3.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (3.3.0)\n",
            "Requirement already satisfied: nltk in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (3.6.1)\n",
            "Requirement already satisfied: kmodes>=0.10.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.11.1)\n",
            "Requirement already satisfied: scipy<=1.5.4 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (1.5.4)\n",
            "Requirement already satisfied: ipywidgets in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (7.6.3)\n",
            "Requirement already satisfied: mlxtend>=0.17.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.19.0)\n",
            "Requirement already satisfied: matplotlib in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (3.3.4)\n",
            "Requirement already satisfied: scikit-learn==0.23.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.23.2)\n",
            "Collecting pandas-profiling>=2.8.0\n",
            "  Using cached pandas_profiling-3.1.0-py2.py3-none-any.whl (261 kB)\n",
            "Requirement already satisfied: seaborn in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.11.1)\n",
            "Requirement already satisfied: wordcloud in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (1.8.1)\n",
            "Requirement already satisfied: numpy==1.19.5 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (1.19.5)\n",
            "Requirement already satisfied: cufflinks>=0.17.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.17.3)\n",
            "Requirement already satisfied: IPython in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (7.22.0)\n",
            "Requirement already satisfied: yellowbrick>=1.0.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (1.3.post1)\n",
            "Requirement already satisfied: joblib in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (1.0.1)\n",
            "Requirement already satisfied: plotly>=4.4.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (5.3.1)\n",
            "Requirement already satisfied: pyLDAvis in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (3.2.2)\n",
            "Requirement already satisfied: scikit-plot in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.3.7)\n",
            "Requirement already satisfied: pyod in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (0.9.4)\n",
            "Requirement already satisfied: gensim<4.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pycaret) (3.8.3)\n",
            "Requirement already satisfied: threadpoolctl>=2.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from scikit-learn==0.23.2->pycaret) (2.1.0)\n",
            "Requirement already satisfied: colorlover>=0.2.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from cufflinks>=0.17.0->pycaret) (0.3.0)\n",
            "Requirement already satisfied: setuptools>=34.4.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from cufflinks>=0.17.0->pycaret) (52.0.0.post20210125)\n",
            "Requirement already satisfied: six>=1.9.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from cufflinks>=0.17.0->pycaret) (1.15.0)\n",
            "Requirement already satisfied: smart-open>=1.8.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from gensim<4.0.0->pycaret) (5.2.1)\n",
            "Requirement already satisfied: Cython==0.29.14 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from gensim<4.0.0->pycaret) (0.29.14)\n",
            "Requirement already satisfied: pickleshare in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from IPython->pycaret) (0.7.5)\n",
            "Requirement already satisfied: traitlets>=4.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from IPython->pycaret) (5.0.5)\n",
            "Requirement already satisfied: backcall in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from IPython->pycaret) (0.2.0)\n",
            "Requirement already satisfied: jedi>=0.16 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from IPython->pycaret) (0.17.2)\n",
            "Requirement already satisfied: colorama in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from IPython->pycaret) (0.4.4)\n",
            "Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from IPython->pycaret) (3.0.17)\n",
            "Requirement already satisfied: pygments in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from IPython->pycaret) (2.8.1)\n",
            "Requirement already satisfied: decorator in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from IPython->pycaret) (5.0.6)\n",
            "Requirement already satisfied: widgetsnbextension~=3.5.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipywidgets->pycaret) (3.5.1)\n",
            "Requirement already satisfied: ipykernel>=4.5.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipywidgets->pycaret) (5.3.4)\n",
            "Requirement already satisfied: jupyterlab-widgets>=1.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipywidgets->pycaret) (1.0.0)\n",
            "Requirement already satisfied: nbformat>=4.2.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipywidgets->pycaret) (5.1.3)\n",
            "Requirement already satisfied: tornado>=4.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipykernel>=4.5.1->ipywidgets->pycaret) (6.1)\n",
            "Requirement already satisfied: jupyter-client in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from ipykernel>=4.5.1->ipywidgets->pycaret) (6.1.12)\n",
            "Requirement already satisfied: parso<0.8.0,>=0.7.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from jedi>=0.16->IPython->pycaret) (0.7.0)\n",
            "Requirement already satisfied: wheel in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from lightgbm>=2.3.1->pycaret) (0.36.2)\n",
            "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.3 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from matplotlib->pycaret) (2.4.7)\n",
            "Requirement already satisfied: pillow>=6.2.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from matplotlib->pycaret) (8.2.0)\n",
            "Requirement already satisfied: kiwisolver>=1.0.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from matplotlib->pycaret) (1.3.1)\n",
            "Requirement already satisfied: python-dateutil>=2.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from matplotlib->pycaret) (2.8.1)\n",
            "Requirement already satisfied: cycler>=0.10 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from matplotlib->pycaret) (0.10.0)\n",
            "Requirement already satisfied: jsonschema!=2.5.0,>=2.4 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbformat>=4.2.0->ipywidgets->pycaret) (3.2.0)\n",
            "Requirement already satisfied: jupyter-core in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbformat>=4.2.0->ipywidgets->pycaret) (4.7.1)\n",
            "Requirement already satisfied: ipython-genutils in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbformat>=4.2.0->ipywidgets->pycaret) (0.2.0)\n",
            "Requirement already satisfied: attrs>=17.4.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from jsonschema!=2.5.0,>=2.4->nbformat>=4.2.0->ipywidgets->pycaret) (20.3.0)\n",
            "Requirement already satisfied: pyrsistent>=0.14.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from jsonschema!=2.5.0,>=2.4->nbformat>=4.2.0->ipywidgets->pycaret) (0.17.3)\n",
            "Requirement already satisfied: llvmlite<0.37,>=0.36.0rc1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from numba<0.54->pycaret) (0.36.0)\n",
            "Requirement already satisfied: pytz>=2017.3 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas->pycaret) (2021.1)\n",
            "Requirement already satisfied: tangled-up-in-unicode==0.1.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling>=2.8.0->pycaret) (0.1.0)\n",
            "Requirement already satisfied: jinja2>=2.11.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling>=2.8.0->pycaret) (2.11.3)\n",
            "Requirement already satisfied: htmlmin>=0.1.12 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling>=2.8.0->pycaret) (0.1.12)\n",
            "Collecting visions[type_image_path]==0.7.4\n",
            "  Using cached visions-0.7.4-py3-none-any.whl (102 kB)\n",
            "Requirement already satisfied: PyYAML>=5.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling>=2.8.0->pycaret) (5.4.1)\n",
            "Requirement already satisfied: pydantic>=1.8.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling>=2.8.0->pycaret) (1.8.2)\n",
            "Requirement already satisfied: tqdm>=4.48.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling>=2.8.0->pycaret) (4.59.0)\n",
            "Requirement already satisfied: missingno>=0.4.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling>=2.8.0->pycaret) (0.5.0)\n",
            "Requirement already satisfied: phik>=0.11.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling>=2.8.0->pycaret) (0.12.0)\n",
            "Requirement already satisfied: requests>=2.24.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling>=2.8.0->pycaret) (2.25.1)\n",
            "Requirement already satisfied: multimethod>=1.4 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling>=2.8.0->pycaret) (1.6)\n",
            "Requirement already satisfied: markupsafe~=2.0.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pandas-profiling>=2.8.0->pycaret) (2.0.1)\n",
            "Requirement already satisfied: networkx>=2.4 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from visions[type_image_path]==0.7.4->pandas-profiling>=2.8.0->pycaret) (2.5)\n",
            "Requirement already satisfied: imagehash in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from visions[type_image_path]==0.7.4->pandas-profiling>=2.8.0->pycaret) (4.2.1)\n",
            "Requirement already satisfied: tenacity>=6.2.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from plotly>=4.4.1->pycaret) (8.0.1)\n",
            "Requirement already satisfied: wcwidth in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0->IPython->pycaret) (0.2.5)\n",
            "Requirement already satisfied: typing-extensions>=3.7.4.3 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pydantic>=1.8.1->pandas-profiling>=2.8.0->pycaret) (3.7.4.3)\n",
            "Requirement already satisfied: urllib3<1.27,>=1.21.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from requests>=2.24.0->pandas-profiling>=2.8.0->pycaret) (1.26.4)\n",
            "Requirement already satisfied: chardet<5,>=3.0.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from requests>=2.24.0->pandas-profiling>=2.8.0->pycaret) (4.0.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from requests>=2.24.0->pandas-profiling>=2.8.0->pycaret) (2020.12.5)\n",
            "Requirement already satisfied: idna<3,>=2.5 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from requests>=2.24.0->pandas-profiling>=2.8.0->pycaret) (2.10)\n",
            "Requirement already satisfied: preshed<3.1.0,>=3.0.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from spacy<2.4.0->pycaret) (3.0.6)\n",
            "Requirement already satisfied: cymem<2.1.0,>=2.0.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from spacy<2.4.0->pycaret) (2.0.6)\n",
            "Requirement already satisfied: thinc<7.5.0,>=7.4.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from spacy<2.4.0->pycaret) (7.4.5)\n",
            "Requirement already satisfied: murmurhash<1.1.0,>=0.28.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from spacy<2.4.0->pycaret) (1.0.6)\n",
            "Requirement already satisfied: wasabi<1.1.0,>=0.4.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from spacy<2.4.0->pycaret) (0.8.2)\n",
            "Requirement already satisfied: plac<1.2.0,>=0.9.6 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from spacy<2.4.0->pycaret) (1.1.3)\n",
            "Requirement already satisfied: catalogue<1.1.0,>=0.0.7 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from spacy<2.4.0->pycaret) (1.0.0)\n",
            "Requirement already satisfied: srsly<1.1.0,>=1.0.2 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from spacy<2.4.0->pycaret) (1.0.5)\n",
            "Requirement already satisfied: blis<0.8.0,>=0.4.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from spacy<2.4.0->pycaret) (0.7.5)\n",
            "Requirement already satisfied: notebook>=4.4.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from widgetsnbextension~=3.5.0->ipywidgets->pycaret) (6.3.0)\n",
            "Requirement already satisfied: terminado>=0.8.3 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.9.4)\n",
            "Requirement already satisfied: prometheus-client in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.10.1)\n",
            "Requirement already satisfied: argon2-cffi in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (20.1.0)\n",
            "Requirement already satisfied: Send2Trash>=1.5.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (1.5.0)\n",
            "Requirement already satisfied: pyzmq>=17 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (20.0.0)\n",
            "Requirement already satisfied: nbconvert in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (6.0.7)\n",
            "Requirement already satisfied: pywin32>=1.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from jupyter-core->nbformat>=4.2.0->ipywidgets->pycaret) (227)\n",
            "Requirement already satisfied: pywinpty>=0.5 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from terminado>=0.8.3->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.5.7)\n",
            "Requirement already satisfied: cffi>=1.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from argon2-cffi->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (1.14.5)\n",
            "Requirement already satisfied: pycparser in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from cffi>=1.0.0->argon2-cffi->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (2.20)\n",
            "Requirement already satisfied: PyWavelets in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from imagehash->visions[type_image_path]==0.7.4->pandas-profiling>=2.8.0->pycaret) (1.1.1)\n",
            "Requirement already satisfied: Flask in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (1.1.2)\n",
            "Requirement already satisfied: gitpython>=2.1.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (3.1.24)\n",
            "Requirement already satisfied: packaging in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (20.9)\n",
            "Requirement already satisfied: sqlparse>=0.3.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (0.4.2)\n",
            "Requirement already satisfied: click>=7.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (7.1.2)\n",
            "Requirement already satisfied: prometheus-flask-exporter in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (0.18.4)\n",
            "Requirement already satisfied: sqlalchemy in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (1.4.7)\n",
            "Requirement already satisfied: cloudpickle in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (1.6.0)\n",
            "Requirement already satisfied: importlib-metadata!=4.7.0,>=3.7.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (3.10.0)\n",
            "Requirement already satisfied: querystring-parser in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (1.2.4)\n",
            "Requirement already satisfied: protobuf>=3.7.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (3.19.0)\n",
            "Requirement already satisfied: entrypoints in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (0.3)\n",
            "Requirement already satisfied: alembic<=1.4.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (1.4.1)\n",
            "Requirement already satisfied: docker>=4.0.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (5.0.3)\n",
            "Requirement already satisfied: databricks-cli>=0.8.7 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (0.16.2)\n",
            "Requirement already satisfied: waitress in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from mlflow->pycaret) (2.0.0)\n",
            "Requirement already satisfied: python-editor>=0.3 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from alembic<=1.4.1->mlflow->pycaret) (1.0.4)\n",
            "Requirement already satisfied: Mako in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from alembic<=1.4.1->mlflow->pycaret) (1.1.5)\n",
            "Requirement already satisfied: tabulate>=0.7.7 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from databricks-cli>=0.8.7->mlflow->pycaret) (0.8.9)\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Requirement already satisfied: websocket-client>=0.32.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from docker>=4.0.0->mlflow->pycaret) (1.2.1)\n",
            "Requirement already satisfied: gitdb<5,>=4.0.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from gitpython>=2.1.0->mlflow->pycaret) (4.0.9)\n",
            "Requirement already satisfied: smmap<6,>=3.0.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from gitdb<5,>=4.0.1->gitpython>=2.1.0->mlflow->pycaret) (5.0.0)\n",
            "Requirement already satisfied: zipp>=0.5 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from importlib-metadata!=4.7.0,>=3.7.0->mlflow->pycaret) (3.4.1)\n",
            "Requirement already satisfied: greenlet!=0.4.17 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from sqlalchemy->mlflow->pycaret) (1.0.0)\n",
            "Requirement already satisfied: itsdangerous>=0.24 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from Flask->mlflow->pycaret) (1.1.0)\n",
            "Requirement already satisfied: Werkzeug>=0.15 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from Flask->mlflow->pycaret) (1.0.1)\n",
            "Requirement already satisfied: nbclient<0.6.0,>=0.5.0 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.5.3)\n",
            "Requirement already satisfied: bleach in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (3.3.0)\n",
            "Requirement already satisfied: testpath in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.4.4)\n",
            "Requirement already satisfied: mistune<2,>=0.8.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.8.4)\n",
            "Requirement already satisfied: pandocfilters>=1.4.1 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (1.4.3)\n",
            "Requirement already satisfied: defusedxml in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.7.1)\n",
            "Requirement already satisfied: jupyterlab-pygments in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.1.2)\n",
            "Requirement already satisfied: async-generator in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbclient<0.6.0,>=0.5.0->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (1.10)\n",
            "Requirement already satisfied: nest-asyncio in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nbclient<0.6.0,>=0.5.0->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (1.5.1)\n",
            "Requirement already satisfied: webencodings in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from bleach->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->pycaret) (0.5.1)\n",
            "Requirement already satisfied: regex in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from nltk->pycaret) (2021.4.4)\n",
            "Requirement already satisfied: future in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pyLDAvis->pycaret) (0.18.2)\n",
            "Requirement already satisfied: funcy in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pyLDAvis->pycaret) (1.16)\n",
            "Requirement already satisfied: numexpr in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pyLDAvis->pycaret) (2.7.3)\n",
            "Requirement already satisfied: statsmodels in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from pyod->pycaret) (0.12.2)\n",
            "Requirement already satisfied: patsy>=0.5 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from statsmodels->pyod->pycaret) (0.5.1)\n",
            "Requirement already satisfied: pynndescent>=0.5 in e:\\users\\jianz\\anaconda3\\lib\\site-packages (from umap-learn->pycaret) (0.5.5)\n",
            "Installing collected packages: visions, pandas-profiling\n",
            "  Attempting uninstall: visions\n",
            "    Found existing installation: visions 0.4.1\n",
            "    Uninstalling visions-0.4.1:\n",
            "      Successfully uninstalled visions-0.4.1\n",
            "  Attempting uninstall: pandas-profiling\n",
            "    Found existing installation: pandas-profiling 2.7.1\n",
            "    Uninstalling pandas-profiling-2.7.1:\n",
            "      Successfully uninstalled pandas-profiling-2.7.1\n",
            "Successfully installed pandas-profiling-3.1.0 visions-0.7.4\n"
          ]
        }
      ],
      "source": [
        "!pip install pycaret"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "cdmyd7qHC0ZG",
        "outputId": "1018b292-2fd2-406a-c5d7-d41bfdfd0de3"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Collecting openpyxl\n",
            "  Downloading openpyxl-3.0.9-py2.py3-none-any.whl (242 kB)\n",
            "Collecting et-xmlfile\n",
            "  Downloading et_xmlfile-1.1.0-py3-none-any.whl (4.7 kB)\n",
            "Installing collected packages: et-xmlfile, openpyxl\n",
            "Successfully installed et-xmlfile-1.1.0 openpyxl-3.0.9\n",
            "Note: you may need to restart the kernel to use updated packages.\n"
          ]
        }
      ],
      "source": [
        "pip install openpyxl"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "XLMo75-mJA6W"
      },
      "outputs": [],
      "source": [
        "matplotlib inline"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "QnmUcTsfKyc_"
      },
      "source": [
        "Set up environment"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "827Tes73H4hL"
      },
      "outputs": [],
      "source": [
        "import pandas as pd\n",
        "import numpy as np\n",
        "import matplotlib.pyplot as plt"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "I63hBY-bK0aQ"
      },
      "source": [
        "Load data"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "jDWXNo59IzcO"
      },
      "outputs": [],
      "source": [
        "data = pd.read_csv('UCI_Credit_Card.csv')"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "hELy8iLLNUHp"
      },
      "source": [
        "Exploratory data analysis"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 222
        },
        "id": "4Hjes6lPNndL",
        "outputId": "cc955c0b-764e-4be7-d080-64ad0f91b41c"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>LIMIT_BAL</th>\n",
              "      <th>SEX</th>\n",
              "      <th>EDUCATION</th>\n",
              "      <th>MARRIAGE</th>\n",
              "      <th>AGE</th>\n",
              "      <th>PAY_0</th>\n",
              "      <th>PAY_2</th>\n",
              "      <th>PAY_3</th>\n",
              "      <th>PAY_4</th>\n",
              "      <th>...</th>\n",
              "      <th>BILL_AMT4</th>\n",
              "      <th>BILL_AMT5</th>\n",
              "      <th>BILL_AMT6</th>\n",
              "      <th>PAY_AMT1</th>\n",
              "      <th>PAY_AMT2</th>\n",
              "      <th>PAY_AMT3</th>\n",
              "      <th>PAY_AMT4</th>\n",
              "      <th>PAY_AMT5</th>\n",
              "      <th>PAY_AMT6</th>\n",
              "      <th>default.payment.next.month</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>24</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>689.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>2</td>\n",
              "      <td>120000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>26</td>\n",
              "      <td>-1</td>\n",
              "      <td>2</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>3272.0</td>\n",
              "      <td>3455.0</td>\n",
              "      <td>3261.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3</td>\n",
              "      <td>90000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>34</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>14331.0</td>\n",
              "      <td>14948.0</td>\n",
              "      <td>15549.0</td>\n",
              "      <td>1518.0</td>\n",
              "      <td>1500.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>5000.0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>4</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>37</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>28314.0</td>\n",
              "      <td>28959.0</td>\n",
              "      <td>29547.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>2019.0</td>\n",
              "      <td>1200.0</td>\n",
              "      <td>1100.0</td>\n",
              "      <td>1069.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>5</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>57</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>20940.0</td>\n",
              "      <td>19146.0</td>\n",
              "      <td>19131.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>36681.0</td>\n",
              "      <td>10000.0</td>\n",
              "      <td>9000.0</td>\n",
              "      <td>689.0</td>\n",
              "      <td>679.0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>5 rows  25 columns</p>\n",
              "</div>"
            ],
            "text/plain": [
              "   ID  LIMIT_BAL  SEX  EDUCATION  MARRIAGE  AGE  PAY_0  PAY_2  PAY_3  PAY_4  \\\n",
              "0   1    20000.0    2          2         1   24      2      2     -1     -1   \n",
              "1   2   120000.0    2          2         2   26     -1      2      0      0   \n",
              "2   3    90000.0    2          2         2   34      0      0      0      0   \n",
              "3   4    50000.0    2          2         1   37      0      0      0      0   \n",
              "4   5    50000.0    1          2         1   57     -1      0     -1      0   \n",
              "\n",
              "   ...  BILL_AMT4  BILL_AMT5  BILL_AMT6  PAY_AMT1  PAY_AMT2  PAY_AMT3  \\\n",
              "0  ...        0.0        0.0        0.0       0.0     689.0       0.0   \n",
              "1  ...     3272.0     3455.0     3261.0       0.0    1000.0    1000.0   \n",
              "2  ...    14331.0    14948.0    15549.0    1518.0    1500.0    1000.0   \n",
              "3  ...    28314.0    28959.0    29547.0    2000.0    2019.0    1200.0   \n",
              "4  ...    20940.0    19146.0    19131.0    2000.0   36681.0   10000.0   \n",
              "\n",
              "   PAY_AMT4  PAY_AMT5  PAY_AMT6  default.payment.next.month  \n",
              "0       0.0       0.0       0.0                           1  \n",
              "1    1000.0       0.0    2000.0                           1  \n",
              "2    1000.0    1000.0    5000.0                           0  \n",
              "3    1100.0    1069.0    1000.0                           0  \n",
              "4    9000.0     689.0     679.0                           0  \n",
              "\n",
              "[5 rows x 25 columns]"
            ]
          },
          "execution_count": 6,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "data.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "fzObbAmuNnlA",
        "outputId": "0ae66704-d2d5-4762-ff4a-28f5dbc77c4f"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "(30000, 25)"
            ]
          },
          "execution_count": 7,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "data.shape"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "vErqYxBhNno5",
        "outputId": "d0da5d83-ccea-4b1c-bf46-2d0305249dd1"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "<class 'pandas.core.frame.DataFrame'>\n",
            "RangeIndex: 30000 entries, 0 to 29999\n",
            "Data columns (total 25 columns):\n",
            " #   Column                      Non-Null Count  Dtype  \n",
            "---  ------                      --------------  -----  \n",
            " 0   ID                          30000 non-null  int64  \n",
            " 1   LIMIT_BAL                   30000 non-null  float64\n",
            " 2   SEX                         30000 non-null  int64  \n",
            " 3   EDUCATION                   30000 non-null  int64  \n",
            " 4   MARRIAGE                    30000 non-null  int64  \n",
            " 5   AGE                         30000 non-null  int64  \n",
            " 6   PAY_0                       30000 non-null  int64  \n",
            " 7   PAY_2                       30000 non-null  int64  \n",
            " 8   PAY_3                       30000 non-null  int64  \n",
            " 9   PAY_4                       30000 non-null  int64  \n",
            " 10  PAY_5                       30000 non-null  int64  \n",
            " 11  PAY_6                       30000 non-null  int64  \n",
            " 12  BILL_AMT1                   30000 non-null  float64\n",
            " 13  BILL_AMT2                   30000 non-null  float64\n",
            " 14  BILL_AMT3                   30000 non-null  float64\n",
            " 15  BILL_AMT4                   30000 non-null  float64\n",
            " 16  BILL_AMT5                   30000 non-null  float64\n",
            " 17  BILL_AMT6                   30000 non-null  float64\n",
            " 18  PAY_AMT1                    30000 non-null  float64\n",
            " 19  PAY_AMT2                    30000 non-null  float64\n",
            " 20  PAY_AMT3                    30000 non-null  float64\n",
            " 21  PAY_AMT4                    30000 non-null  float64\n",
            " 22  PAY_AMT5                    30000 non-null  float64\n",
            " 23  PAY_AMT6                    30000 non-null  float64\n",
            " 24  default.payment.next.month  30000 non-null  int64  \n",
            "dtypes: float64(13), int64(12)\n",
            "memory usage: 5.7 MB\n"
          ]
        }
      ],
      "source": [
        "data.info() #not all features have the right dtype; to be cleaned"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "oeXHE0dFoK8F",
        "outputId": "019a7c9b-c297-4fe4-a2c3-5f94c31719dd"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "ID                            0\n",
              "LIMIT_BAL                     0\n",
              "SEX                           0\n",
              "EDUCATION                     0\n",
              "MARRIAGE                      0\n",
              "AGE                           0\n",
              "PAY_0                         0\n",
              "PAY_2                         0\n",
              "PAY_3                         0\n",
              "PAY_4                         0\n",
              "PAY_5                         0\n",
              "PAY_6                         0\n",
              "BILL_AMT1                     0\n",
              "BILL_AMT2                     0\n",
              "BILL_AMT3                     0\n",
              "BILL_AMT4                     0\n",
              "BILL_AMT5                     0\n",
              "BILL_AMT6                     0\n",
              "PAY_AMT1                      0\n",
              "PAY_AMT2                      0\n",
              "PAY_AMT3                      0\n",
              "PAY_AMT4                      0\n",
              "PAY_AMT5                      0\n",
              "PAY_AMT6                      0\n",
              "default.payment.next.month    0\n",
              "dtype: int64"
            ]
          },
          "execution_count": 9,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "data.isna().sum()  #no missing values"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "_64xNGsEuxBs",
        "outputId": "f46525e9-915c-4adc-d3b8-6694cf0fc69e"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "ID                            30000\n",
              "LIMIT_BAL                        81\n",
              "SEX                               2\n",
              "EDUCATION                         7\n",
              "MARRIAGE                          4\n",
              "AGE                              56\n",
              "PAY_0                            11\n",
              "PAY_2                            11\n",
              "PAY_3                            11\n",
              "PAY_4                            11\n",
              "PAY_5                            10\n",
              "PAY_6                            10\n",
              "BILL_AMT1                     22723\n",
              "BILL_AMT2                     22346\n",
              "BILL_AMT3                     22026\n",
              "BILL_AMT4                     21548\n",
              "BILL_AMT5                     21010\n",
              "BILL_AMT6                     20604\n",
              "PAY_AMT1                       7943\n",
              "PAY_AMT2                       7899\n",
              "PAY_AMT3                       7518\n",
              "PAY_AMT4                       6937\n",
              "PAY_AMT5                       6897\n",
              "PAY_AMT6                       6939\n",
              "default.payment.next.month        2\n",
              "dtype: int64"
            ]
          },
          "execution_count": 10,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "data.nunique() #number of EDUCATION and MARRIAGE categories doesn't align with data dictionary; to be cleaned"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "0v44Q8vgppxa",
        "outputId": "f50267da-0cbb-423f-eb7b-48b76cd2bbad"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "0    23364\n",
              "1     6636\n",
              "Name: default.payment.next.month, dtype: int64"
            ]
          },
          "execution_count": 11,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "#check label balance \n",
        "data['default.payment.next.month'].value_counts() #target is imbalanced; rebalancing needed"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "jU2XAyqINV6Y"
      },
      "outputs": [],
      "source": [
        "#vizualizations\n",
        "# from pandas_profiling import ProfileReport\n",
        "# profile = ProfileReport(data)\n",
        "# profile"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "Ir6LAaP0geId"
      },
      "source": [
        "Data cleaning"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "BkRaW2c3l4jH"
      },
      "outputs": [],
      "source": [
        "#rename PAY_0 to PAY_1 for ease/logic\n",
        "data.rename(columns={'PAY_0':'PAY_1'}, inplace=True)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "IjkjQ-17HDk1"
      },
      "outputs": [],
      "source": [
        "#rename PAY_0 to PAY_1 for ease/logic\n",
        "data.rename(columns={'default.payment.next.month':'DEFAULT'}, inplace=True)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "IhKGUWDclgJ4"
      },
      "outputs": [],
      "source": [
        "#convert SEX, EDUCATION, MARRIAGE, PAY_1, PAY_2, PAY_3, PAY_4, PAY_5, PAY_6, default_payment_next_month to categorical features\n",
        "data['SEX'] = pd.Categorical(data.SEX)\n",
        "data['EDUCATION'] = pd.Categorical(data.EDUCATION)\n",
        "data['MARRIAGE'] = pd.Categorical(data.MARRIAGE)\n",
        "data['PAY_1'] = pd.Categorical(data.PAY_1)\n",
        "data['PAY_2'] = pd.Categorical(data.PAY_2)\n",
        "data['PAY_3'] = pd.Categorical(data.PAY_3)\n",
        "data['PAY_4'] = pd.Categorical(data.PAY_4)\n",
        "data['PAY_5'] = pd.Categorical(data.PAY_5)\n",
        "data['PAY_6'] = pd.Categorical(data.PAY_6)\n",
        "data['DEFAULT'] = pd.Categorical(data.DEFAULT)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "9kHhqY42mpdV",
        "outputId": "11661127-799d-4d4a-ef5d-4b584ddf0c4a"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "<class 'pandas.core.frame.DataFrame'>\n",
            "RangeIndex: 30000 entries, 0 to 29999\n",
            "Data columns (total 25 columns):\n",
            " #   Column     Non-Null Count  Dtype   \n",
            "---  ------     --------------  -----   \n",
            " 0   ID         30000 non-null  int64   \n",
            " 1   LIMIT_BAL  30000 non-null  float64 \n",
            " 2   SEX        30000 non-null  category\n",
            " 3   EDUCATION  30000 non-null  category\n",
            " 4   MARRIAGE   30000 non-null  category\n",
            " 5   AGE        30000 non-null  int64   \n",
            " 6   PAY_1      30000 non-null  category\n",
            " 7   PAY_2      30000 non-null  category\n",
            " 8   PAY_3      30000 non-null  category\n",
            " 9   PAY_4      30000 non-null  category\n",
            " 10  PAY_5      30000 non-null  category\n",
            " 11  PAY_6      30000 non-null  category\n",
            " 12  BILL_AMT1  30000 non-null  float64 \n",
            " 13  BILL_AMT2  30000 non-null  float64 \n",
            " 14  BILL_AMT3  30000 non-null  float64 \n",
            " 15  BILL_AMT4  30000 non-null  float64 \n",
            " 16  BILL_AMT5  30000 non-null  float64 \n",
            " 17  BILL_AMT6  30000 non-null  float64 \n",
            " 18  PAY_AMT1   30000 non-null  float64 \n",
            " 19  PAY_AMT2   30000 non-null  float64 \n",
            " 20  PAY_AMT3   30000 non-null  float64 \n",
            " 21  PAY_AMT4   30000 non-null  float64 \n",
            " 22  PAY_AMT5   30000 non-null  float64 \n",
            " 23  PAY_AMT6   30000 non-null  float64 \n",
            " 24  DEFAULT    30000 non-null  category\n",
            "dtypes: category(10), float64(13), int64(2)\n",
            "memory usage: 3.7 MB\n"
          ]
        }
      ],
      "source": [
        "data.info()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "w3TRmeM6gdJN",
        "outputId": "04ec23c8-a972-46a0-a1f0-7d119c98da30"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>LIMIT_BAL</th>\n",
              "      <th>SEX</th>\n",
              "      <th>EDUCATION</th>\n",
              "      <th>MARRIAGE</th>\n",
              "      <th>AGE</th>\n",
              "      <th>PAY_1</th>\n",
              "      <th>PAY_2</th>\n",
              "      <th>PAY_3</th>\n",
              "      <th>PAY_4</th>\n",
              "      <th>PAY_5</th>\n",
              "      <th>...</th>\n",
              "      <th>BILL_AMT4</th>\n",
              "      <th>BILL_AMT5</th>\n",
              "      <th>BILL_AMT6</th>\n",
              "      <th>PAY_AMT1</th>\n",
              "      <th>PAY_AMT2</th>\n",
              "      <th>PAY_AMT3</th>\n",
              "      <th>PAY_AMT4</th>\n",
              "      <th>PAY_AMT5</th>\n",
              "      <th>PAY_AMT6</th>\n",
              "      <th>DEFAULT</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>20000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>24</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>-2</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>689.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>120000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>26</td>\n",
              "      <td>-1</td>\n",
              "      <td>2</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>3272.0</td>\n",
              "      <td>3455.0</td>\n",
              "      <td>3261.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>90000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>34</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>14331.0</td>\n",
              "      <td>14948.0</td>\n",
              "      <td>15549.0</td>\n",
              "      <td>1518.0</td>\n",
              "      <td>1500.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>5000.0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>50000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>37</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>28314.0</td>\n",
              "      <td>28959.0</td>\n",
              "      <td>29547.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>2019.0</td>\n",
              "      <td>1200.0</td>\n",
              "      <td>1100.0</td>\n",
              "      <td>1069.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>50000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>57</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>20940.0</td>\n",
              "      <td>19146.0</td>\n",
              "      <td>19131.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>36681.0</td>\n",
              "      <td>10000.0</td>\n",
              "      <td>9000.0</td>\n",
              "      <td>689.0</td>\n",
              "      <td>679.0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29995</th>\n",
              "      <td>220000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>1</td>\n",
              "      <td>39</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>88004.0</td>\n",
              "      <td>31237.0</td>\n",
              "      <td>15980.0</td>\n",
              "      <td>8500.0</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>5003.0</td>\n",
              "      <td>3047.0</td>\n",
              "      <td>5000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29996</th>\n",
              "      <td>150000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>2</td>\n",
              "      <td>43</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>8979.0</td>\n",
              "      <td>5190.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>1837.0</td>\n",
              "      <td>3526.0</td>\n",
              "      <td>8998.0</td>\n",
              "      <td>129.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29997</th>\n",
              "      <td>30000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>37</td>\n",
              "      <td>4</td>\n",
              "      <td>3</td>\n",
              "      <td>2</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>20878.0</td>\n",
              "      <td>20582.0</td>\n",
              "      <td>19357.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>22000.0</td>\n",
              "      <td>4200.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>3100.0</td>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29998</th>\n",
              "      <td>80000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>1</td>\n",
              "      <td>41</td>\n",
              "      <td>1</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>52774.0</td>\n",
              "      <td>11855.0</td>\n",
              "      <td>48944.0</td>\n",
              "      <td>85900.0</td>\n",
              "      <td>3409.0</td>\n",
              "      <td>1178.0</td>\n",
              "      <td>1926.0</td>\n",
              "      <td>52964.0</td>\n",
              "      <td>1804.0</td>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29999</th>\n",
              "      <td>50000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>46</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>36535.0</td>\n",
              "      <td>32428.0</td>\n",
              "      <td>15313.0</td>\n",
              "      <td>2078.0</td>\n",
              "      <td>1800.0</td>\n",
              "      <td>1430.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>30000 rows  24 columns</p>\n",
              "</div>"
            ],
            "text/plain": [
              "       LIMIT_BAL SEX EDUCATION MARRIAGE  AGE PAY_1 PAY_2 PAY_3 PAY_4 PAY_5  \\\n",
              "0        20000.0   2         2        1   24     2     2    -1    -1    -2   \n",
              "1       120000.0   2         2        2   26    -1     2     0     0     0   \n",
              "2        90000.0   2         2        2   34     0     0     0     0     0   \n",
              "3        50000.0   2         2        1   37     0     0     0     0     0   \n",
              "4        50000.0   1         2        1   57    -1     0    -1     0     0   \n",
              "...          ...  ..       ...      ...  ...   ...   ...   ...   ...   ...   \n",
              "29995   220000.0   1         3        1   39     0     0     0     0     0   \n",
              "29996   150000.0   1         3        2   43    -1    -1    -1    -1     0   \n",
              "29997    30000.0   1         2        2   37     4     3     2    -1     0   \n",
              "29998    80000.0   1         3        1   41     1    -1     0     0     0   \n",
              "29999    50000.0   1         2        1   46     0     0     0     0     0   \n",
              "\n",
              "       ... BILL_AMT4  BILL_AMT5  BILL_AMT6  PAY_AMT1  PAY_AMT2  PAY_AMT3  \\\n",
              "0      ...       0.0        0.0        0.0       0.0     689.0       0.0   \n",
              "1      ...    3272.0     3455.0     3261.0       0.0    1000.0    1000.0   \n",
              "2      ...   14331.0    14948.0    15549.0    1518.0    1500.0    1000.0   \n",
              "3      ...   28314.0    28959.0    29547.0    2000.0    2019.0    1200.0   \n",
              "4      ...   20940.0    19146.0    19131.0    2000.0   36681.0   10000.0   \n",
              "...    ...       ...        ...        ...       ...       ...       ...   \n",
              "29995  ...   88004.0    31237.0    15980.0    8500.0   20000.0    5003.0   \n",
              "29996  ...    8979.0     5190.0        0.0    1837.0    3526.0    8998.0   \n",
              "29997  ...   20878.0    20582.0    19357.0       0.0       0.0   22000.0   \n",
              "29998  ...   52774.0    11855.0    48944.0   85900.0    3409.0    1178.0   \n",
              "29999  ...   36535.0    32428.0    15313.0    2078.0    1800.0    1430.0   \n",
              "\n",
              "       PAY_AMT4  PAY_AMT5  PAY_AMT6  DEFAULT  \n",
              "0           0.0       0.0       0.0        1  \n",
              "1        1000.0       0.0    2000.0        1  \n",
              "2        1000.0    1000.0    5000.0        0  \n",
              "3        1100.0    1069.0    1000.0        0  \n",
              "4        9000.0     689.0     679.0        0  \n",
              "...         ...       ...       ...      ...  \n",
              "29995    3047.0    5000.0    1000.0        0  \n",
              "29996     129.0       0.0       0.0        0  \n",
              "29997    4200.0    2000.0    3100.0        1  \n",
              "29998    1926.0   52964.0    1804.0        1  \n",
              "29999    1000.0    1000.0    1000.0        1  \n",
              "\n",
              "[30000 rows x 24 columns]"
            ]
          },
          "execution_count": 17,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "#remove IDs that simply increment by 1; unnecessary noise\n",
        "data.drop(['ID'], axis=1)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "ChxjFVPCgna-"
      },
      "outputs": [],
      "source": [
        "#merged education category #6 (unknown) with education category #5 (unknown)\n",
        "data['EDUCATION'] = data['EDUCATION'].replace(6,5)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "Q_kzfNWhrZVq",
        "outputId": "21b0e77d-a0bf-44a3-a9c8-cab140c680d0"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "2    14030\n",
              "1    10585\n",
              "3     4917\n",
              "5      331\n",
              "4      123\n",
              "0       14\n",
              "Name: EDUCATION, dtype: int64"
            ]
          },
          "execution_count": 19,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "#check label balance \n",
        "data['EDUCATION'].value_counts()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "OmQ7ELxSn_-0"
      },
      "outputs": [],
      "source": [
        "#merged education category #0 (not listed in data dictionary) with education category #5 (unknown)\n",
        "data['EDUCATION'] = data['EDUCATION'].replace(0,5)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "gs1yo8wKrbux",
        "outputId": "461b588a-9518-4aee-bc41-5dd5e4e117aa"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "2    14030\n",
              "1    10585\n",
              "3     4917\n",
              "5      345\n",
              "4      123\n",
              "Name: EDUCATION, dtype: int64"
            ]
          },
          "execution_count": 21,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "#check label balance \n",
        "data['EDUCATION'].value_counts()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "Frd6SnuBoiCr"
      },
      "outputs": [],
      "source": [
        "#keep marriage category #0 (not listed in data dictionary) as its own seperate category to signify \"unknown\""
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "nkv7S4xLhCi1"
      },
      "source": [
        "Feature engineering"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "q3edRc8-wV5t"
      },
      "source": [
        "*Clustering*"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "1sW7Jgb1gwpL"
      },
      "outputs": [],
      "source": [
        "X = data.copy()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "DoiHDSz0r1jD"
      },
      "outputs": [],
      "source": [
        "#standarize data\n",
        "from sklearn.preprocessing import StandardScaler\n",
        "\n",
        "scaler = StandardScaler()\n",
        "features = ['LIMIT_BAL', 'AGE', 'BILL_AMT1', 'BILL_AMT2', 'BILL_AMT3', 'BILL_AMT4', 'BILL_AMT5', 'BILL_AMT6']\n",
        "X[features] = scaler.fit_transform(X[features])"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "wRjiwxnyr1mY",
        "outputId": "a86c478e-2fdd-45a7-b392-e3561b04c498"
      },
      "outputs": [
        {
          "data": {
            "image/png": "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\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          },
          "output_type": "display_data"
        },
        {
          "data": {
            "image/png": "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\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          },
          "output_type": "display_data"
        }
      ],
      "source": [
        "#tune hyperparameters - The Elbow Method\n",
        "from sklearn.cluster import KMeans\n",
        "from sklearn.metrics import silhouette_samples, silhouette_score\n",
        "\n",
        "inertias = {}\n",
        "silhouettes = {}\n",
        "\n",
        "for k in range(2, 11):\n",
        "    kmeans = KMeans(n_clusters = k, random_state = 123).fit(X)\n",
        "    inertias[k] = kmeans.inertia_ \n",
        "    silhouettes[k] = silhouette_score(X, kmeans.labels_, metric = 'euclidean')\n",
        "\n",
        "plt.figure();\n",
        "plt.plot(list(inertias.keys()), list(inertias.values()));\n",
        "plt.title('K-Means, Elbow Method')\n",
        "plt.xlabel(\"Number of clusters, K\");\n",
        "plt.ylabel(\"Inertia\");\n",
        "\n",
        "plt.figure();\n",
        "plt.plot(list(silhouettes.keys()), list(silhouettes.values()));\n",
        "plt.title(\"K-Means, Elbow Method\")\n",
        "plt.xlabel(\"Number of clusters, K\");\n",
        "plt.ylabel(\"Silhouette\");"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "7TOOtxjpr1pm"
      },
      "outputs": [],
      "source": [
        "#train the K-Means model on the dataset\n",
        "kmeans = KMeans(n_clusters = 8,init = 'k-means++',random_state = 123)\n",
        "y_kmeans = kmeans.fit_predict(X)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "J3SC-5UfwKko",
        "outputId": "ff0af34f-b1e6-4351-ecc5-8e9c10417df2"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "[0 0 0 ... 0 3 0]\n"
          ]
        }
      ],
      "source": [
        "print(y_kmeans)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "y4d4YVgsM3GC"
      },
      "outputs": [],
      "source": [
        "data['CLUSTER'] = y_kmeans"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "d5eOk5OgNBEF",
        "outputId": "404a5509-bd5b-4e95-b33e-14bccdb21f97"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>LIMIT_BAL</th>\n",
              "      <th>SEX</th>\n",
              "      <th>EDUCATION</th>\n",
              "      <th>MARRIAGE</th>\n",
              "      <th>AGE</th>\n",
              "      <th>PAY_1</th>\n",
              "      <th>PAY_2</th>\n",
              "      <th>PAY_3</th>\n",
              "      <th>PAY_4</th>\n",
              "      <th>...</th>\n",
              "      <th>BILL_AMT5</th>\n",
              "      <th>BILL_AMT6</th>\n",
              "      <th>PAY_AMT1</th>\n",
              "      <th>PAY_AMT2</th>\n",
              "      <th>PAY_AMT3</th>\n",
              "      <th>PAY_AMT4</th>\n",
              "      <th>PAY_AMT5</th>\n",
              "      <th>PAY_AMT6</th>\n",
              "      <th>DEFAULT</th>\n",
              "      <th>CLUSTER</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>24</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>689.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>2</td>\n",
              "      <td>120000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>26</td>\n",
              "      <td>-1</td>\n",
              "      <td>2</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>3455.0</td>\n",
              "      <td>3261.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3</td>\n",
              "      <td>90000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>34</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>14948.0</td>\n",
              "      <td>15549.0</td>\n",
              "      <td>1518.0</td>\n",
              "      <td>1500.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>5000.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>4</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>37</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>28959.0</td>\n",
              "      <td>29547.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>2019.0</td>\n",
              "      <td>1200.0</td>\n",
              "      <td>1100.0</td>\n",
              "      <td>1069.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>5</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>57</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>19146.0</td>\n",
              "      <td>19131.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>36681.0</td>\n",
              "      <td>10000.0</td>\n",
              "      <td>9000.0</td>\n",
              "      <td>689.0</td>\n",
              "      <td>679.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29995</th>\n",
              "      <td>29996</td>\n",
              "      <td>220000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>1</td>\n",
              "      <td>39</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>31237.0</td>\n",
              "      <td>15980.0</td>\n",
              "      <td>8500.0</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>5003.0</td>\n",
              "      <td>3047.0</td>\n",
              "      <td>5000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29996</th>\n",
              "      <td>29997</td>\n",
              "      <td>150000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>2</td>\n",
              "      <td>43</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>5190.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>1837.0</td>\n",
              "      <td>3526.0</td>\n",
              "      <td>8998.0</td>\n",
              "      <td>129.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29997</th>\n",
              "      <td>29998</td>\n",
              "      <td>30000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>37</td>\n",
              "      <td>4</td>\n",
              "      <td>3</td>\n",
              "      <td>2</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>20582.0</td>\n",
              "      <td>19357.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>22000.0</td>\n",
              "      <td>4200.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>3100.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29998</th>\n",
              "      <td>29999</td>\n",
              "      <td>80000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>1</td>\n",
              "      <td>41</td>\n",
              "      <td>1</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>11855.0</td>\n",
              "      <td>48944.0</td>\n",
              "      <td>85900.0</td>\n",
              "      <td>3409.0</td>\n",
              "      <td>1178.0</td>\n",
              "      <td>1926.0</td>\n",
              "      <td>52964.0</td>\n",
              "      <td>1804.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29999</th>\n",
              "      <td>30000</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>46</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>32428.0</td>\n",
              "      <td>15313.0</td>\n",
              "      <td>2078.0</td>\n",
              "      <td>1800.0</td>\n",
              "      <td>1430.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>30000 rows  26 columns</p>\n",
              "</div>"
            ],
            "text/plain": [
              "          ID  LIMIT_BAL SEX EDUCATION MARRIAGE  AGE PAY_1 PAY_2 PAY_3 PAY_4  \\\n",
              "0          1    20000.0   2         2        1   24     2     2    -1    -1   \n",
              "1          2   120000.0   2         2        2   26    -1     2     0     0   \n",
              "2          3    90000.0   2         2        2   34     0     0     0     0   \n",
              "3          4    50000.0   2         2        1   37     0     0     0     0   \n",
              "4          5    50000.0   1         2        1   57    -1     0    -1     0   \n",
              "...      ...        ...  ..       ...      ...  ...   ...   ...   ...   ...   \n",
              "29995  29996   220000.0   1         3        1   39     0     0     0     0   \n",
              "29996  29997   150000.0   1         3        2   43    -1    -1    -1    -1   \n",
              "29997  29998    30000.0   1         2        2   37     4     3     2    -1   \n",
              "29998  29999    80000.0   1         3        1   41     1    -1     0     0   \n",
              "29999  30000    50000.0   1         2        1   46     0     0     0     0   \n",
              "\n",
              "       ... BILL_AMT5 BILL_AMT6  PAY_AMT1  PAY_AMT2  PAY_AMT3  PAY_AMT4  \\\n",
              "0      ...       0.0       0.0       0.0     689.0       0.0       0.0   \n",
              "1      ...    3455.0    3261.0       0.0    1000.0    1000.0    1000.0   \n",
              "2      ...   14948.0   15549.0    1518.0    1500.0    1000.0    1000.0   \n",
              "3      ...   28959.0   29547.0    2000.0    2019.0    1200.0    1100.0   \n",
              "4      ...   19146.0   19131.0    2000.0   36681.0   10000.0    9000.0   \n",
              "...    ...       ...       ...       ...       ...       ...       ...   \n",
              "29995  ...   31237.0   15980.0    8500.0   20000.0    5003.0    3047.0   \n",
              "29996  ...    5190.0       0.0    1837.0    3526.0    8998.0     129.0   \n",
              "29997  ...   20582.0   19357.0       0.0       0.0   22000.0    4200.0   \n",
              "29998  ...   11855.0   48944.0   85900.0    3409.0    1178.0    1926.0   \n",
              "29999  ...   32428.0   15313.0    2078.0    1800.0    1430.0    1000.0   \n",
              "\n",
              "       PAY_AMT5  PAY_AMT6  DEFAULT  CLUSTER  \n",
              "0           0.0       0.0        1        0  \n",
              "1           0.0    2000.0        1        0  \n",
              "2        1000.0    5000.0        0        0  \n",
              "3        1069.0    1000.0        0        0  \n",
              "4         689.0     679.0        0        0  \n",
              "...         ...       ...      ...      ...  \n",
              "29995    5000.0    1000.0        0        0  \n",
              "29996       0.0       0.0        0        0  \n",
              "29997    2000.0    3100.0        1        0  \n",
              "29998   52964.0    1804.0        1        3  \n",
              "29999    1000.0    1000.0        1        0  \n",
              "\n",
              "[30000 rows x 26 columns]"
            ]
          },
          "execution_count": 29,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "data"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "SV1XYYebNobL",
        "outputId": "13cdc8e2-5877-4674-9877-cc9557730387"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "<class 'pandas.core.frame.DataFrame'>\n",
            "RangeIndex: 30000 entries, 0 to 29999\n",
            "Data columns (total 26 columns):\n",
            " #   Column     Non-Null Count  Dtype   \n",
            "---  ------     --------------  -----   \n",
            " 0   ID         30000 non-null  int64   \n",
            " 1   LIMIT_BAL  30000 non-null  float64 \n",
            " 2   SEX        30000 non-null  category\n",
            " 3   EDUCATION  30000 non-null  category\n",
            " 4   MARRIAGE   30000 non-null  category\n",
            " 5   AGE        30000 non-null  int64   \n",
            " 6   PAY_1      30000 non-null  category\n",
            " 7   PAY_2      30000 non-null  category\n",
            " 8   PAY_3      30000 non-null  category\n",
            " 9   PAY_4      30000 non-null  category\n",
            " 10  PAY_5      30000 non-null  category\n",
            " 11  PAY_6      30000 non-null  category\n",
            " 12  BILL_AMT1  30000 non-null  float64 \n",
            " 13  BILL_AMT2  30000 non-null  float64 \n",
            " 14  BILL_AMT3  30000 non-null  float64 \n",
            " 15  BILL_AMT4  30000 non-null  float64 \n",
            " 16  BILL_AMT5  30000 non-null  float64 \n",
            " 17  BILL_AMT6  30000 non-null  float64 \n",
            " 18  PAY_AMT1   30000 non-null  float64 \n",
            " 19  PAY_AMT2   30000 non-null  float64 \n",
            " 20  PAY_AMT3   30000 non-null  float64 \n",
            " 21  PAY_AMT4   30000 non-null  float64 \n",
            " 22  PAY_AMT5   30000 non-null  float64 \n",
            " 23  PAY_AMT6   30000 non-null  float64 \n",
            " 24  DEFAULT    30000 non-null  category\n",
            " 25  CLUSTER    30000 non-null  int32   \n",
            "dtypes: category(10), float64(13), int32(1), int64(2)\n",
            "memory usage: 3.8 MB\n"
          ]
        }
      ],
      "source": [
        "data.info()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "ggxfyJ7JNpcb"
      },
      "outputs": [],
      "source": [
        "#convert CLUSTER to a categorical feature\n",
        "data['CLUSTER'] = pd.Categorical(data.CLUSTER)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "oPmv7CB5BOKm"
      },
      "source": [
        "Feature interactions"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "WdC0fbPYBP0d",
        "outputId": "70ebd2ef-2408-436f-e2a7-0eadd585c895"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>LIMIT_BAL</th>\n",
              "      <th>SEX</th>\n",
              "      <th>EDUCATION</th>\n",
              "      <th>MARRIAGE</th>\n",
              "      <th>AGE</th>\n",
              "      <th>PAY_1</th>\n",
              "      <th>PAY_2</th>\n",
              "      <th>PAY_3</th>\n",
              "      <th>PAY_4</th>\n",
              "      <th>...</th>\n",
              "      <th>PAY_AMT5</th>\n",
              "      <th>PAY_AMT6</th>\n",
              "      <th>DEFAULT</th>\n",
              "      <th>CLUSTER</th>\n",
              "      <th>BAL_REMAINING_6</th>\n",
              "      <th>BAL_REMAINING_5</th>\n",
              "      <th>BAL_REMAINING_4</th>\n",
              "      <th>BAL_REMAINING_3</th>\n",
              "      <th>BAL_REMAINING_2</th>\n",
              "      <th>BAL_REMAINING_1</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>24</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>19311.0</td>\n",
              "      <td>16898.0</td>\n",
              "      <td>16087.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>2</td>\n",
              "      <td>120000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>26</td>\n",
              "      <td>-1</td>\n",
              "      <td>2</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>116739.0</td>\n",
              "      <td>116545.0</td>\n",
              "      <td>116728.0</td>\n",
              "      <td>117318.0</td>\n",
              "      <td>118275.0</td>\n",
              "      <td>117318.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3</td>\n",
              "      <td>90000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>34</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>5000.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>74451.0</td>\n",
              "      <td>75052.0</td>\n",
              "      <td>75669.0</td>\n",
              "      <td>76441.0</td>\n",
              "      <td>75973.0</td>\n",
              "      <td>60761.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>4</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>37</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1069.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>20453.0</td>\n",
              "      <td>21041.0</td>\n",
              "      <td>21686.0</td>\n",
              "      <td>709.0</td>\n",
              "      <td>1767.0</td>\n",
              "      <td>3010.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>5</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>57</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>689.0</td>\n",
              "      <td>679.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>30869.0</td>\n",
              "      <td>30854.0</td>\n",
              "      <td>29060.0</td>\n",
              "      <td>14165.0</td>\n",
              "      <td>44330.0</td>\n",
              "      <td>41383.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29995</th>\n",
              "      <td>29996</td>\n",
              "      <td>220000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>1</td>\n",
              "      <td>39</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>5000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>204020.0</td>\n",
              "      <td>188763.0</td>\n",
              "      <td>131996.0</td>\n",
              "      <td>11635.0</td>\n",
              "      <td>27185.0</td>\n",
              "      <td>31052.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29996</th>\n",
              "      <td>29997</td>\n",
              "      <td>150000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>2</td>\n",
              "      <td>43</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>150000.0</td>\n",
              "      <td>144810.0</td>\n",
              "      <td>141021.0</td>\n",
              "      <td>146498.0</td>\n",
              "      <td>148172.0</td>\n",
              "      <td>148317.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29997</th>\n",
              "      <td>29998</td>\n",
              "      <td>30000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>37</td>\n",
              "      <td>4</td>\n",
              "      <td>3</td>\n",
              "      <td>2</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>3100.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>10643.0</td>\n",
              "      <td>9418.0</td>\n",
              "      <td>9122.0</td>\n",
              "      <td>27242.0</td>\n",
              "      <td>26644.0</td>\n",
              "      <td>26435.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29998</th>\n",
              "      <td>29999</td>\n",
              "      <td>80000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>1</td>\n",
              "      <td>41</td>\n",
              "      <td>1</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>52964.0</td>\n",
              "      <td>1804.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>31056.0</td>\n",
              "      <td>68145.0</td>\n",
              "      <td>27226.0</td>\n",
              "      <td>3696.0</td>\n",
              "      <td>1621.0</td>\n",
              "      <td>81645.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29999</th>\n",
              "      <td>30000</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>46</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>34687.0</td>\n",
              "      <td>17572.0</td>\n",
              "      <td>13465.0</td>\n",
              "      <td>236.0</td>\n",
              "      <td>1095.0</td>\n",
              "      <td>2071.0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>30000 rows  32 columns</p>\n",
              "</div>"
            ],
            "text/plain": [
              "          ID  LIMIT_BAL SEX EDUCATION MARRIAGE  AGE PAY_1 PAY_2 PAY_3 PAY_4  \\\n",
              "0          1    20000.0   2         2        1   24     2     2    -1    -1   \n",
              "1          2   120000.0   2         2        2   26    -1     2     0     0   \n",
              "2          3    90000.0   2         2        2   34     0     0     0     0   \n",
              "3          4    50000.0   2         2        1   37     0     0     0     0   \n",
              "4          5    50000.0   1         2        1   57    -1     0    -1     0   \n",
              "...      ...        ...  ..       ...      ...  ...   ...   ...   ...   ...   \n",
              "29995  29996   220000.0   1         3        1   39     0     0     0     0   \n",
              "29996  29997   150000.0   1         3        2   43    -1    -1    -1    -1   \n",
              "29997  29998    30000.0   1         2        2   37     4     3     2    -1   \n",
              "29998  29999    80000.0   1         3        1   41     1    -1     0     0   \n",
              "29999  30000    50000.0   1         2        1   46     0     0     0     0   \n",
              "\n",
              "       ... PAY_AMT5 PAY_AMT6  DEFAULT  CLUSTER  BAL_REMAINING_6  \\\n",
              "0      ...      0.0      0.0        1        0          20000.0   \n",
              "1      ...      0.0   2000.0        1        0         116739.0   \n",
              "2      ...   1000.0   5000.0        0        0          74451.0   \n",
              "3      ...   1069.0   1000.0        0        0          20453.0   \n",
              "4      ...    689.0    679.0        0        0          30869.0   \n",
              "...    ...      ...      ...      ...      ...              ...   \n",
              "29995  ...   5000.0   1000.0        0        0         204020.0   \n",
              "29996  ...      0.0      0.0        0        0         150000.0   \n",
              "29997  ...   2000.0   3100.0        1        0          10643.0   \n",
              "29998  ...  52964.0   1804.0        1        3          31056.0   \n",
              "29999  ...   1000.0   1000.0        1        0          34687.0   \n",
              "\n",
              "       BAL_REMAINING_5  BAL_REMAINING_4  BAL_REMAINING_3  BAL_REMAINING_2  \\\n",
              "0              20000.0          20000.0          19311.0          16898.0   \n",
              "1             116545.0         116728.0         117318.0         118275.0   \n",
              "2              75052.0          75669.0          76441.0          75973.0   \n",
              "3              21041.0          21686.0            709.0           1767.0   \n",
              "4              30854.0          29060.0          14165.0          44330.0   \n",
              "...                ...              ...              ...              ...   \n",
              "29995         188763.0         131996.0          11635.0          27185.0   \n",
              "29996         144810.0         141021.0         146498.0         148172.0   \n",
              "29997           9418.0           9122.0          27242.0          26644.0   \n",
              "29998          68145.0          27226.0           3696.0           1621.0   \n",
              "29999          17572.0          13465.0            236.0           1095.0   \n",
              "\n",
              "       BAL_REMAINING_1  \n",
              "0              16087.0  \n",
              "1             117318.0  \n",
              "2              60761.0  \n",
              "3               3010.0  \n",
              "4              41383.0  \n",
              "...                ...  \n",
              "29995          31052.0  \n",
              "29996         148317.0  \n",
              "29997          26435.0  \n",
              "29998          81645.0  \n",
              "29999           2071.0  \n",
              "\n",
              "[30000 rows x 32 columns]"
            ]
          },
          "execution_count": 32,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "#create feature that show the balance of credit remaining each month\n",
        "data['BAL_REMAINING_6'] = data.LIMIT_BAL - data.BILL_AMT6\n",
        "data['BAL_REMAINING_5'] = data.LIMIT_BAL - data.BILL_AMT5\n",
        "data['BAL_REMAINING_4'] = data.LIMIT_BAL - data.BILL_AMT4\n",
        "data['BAL_REMAINING_3'] = data.LIMIT_BAL - data.BILL_AMT3\n",
        "data['BAL_REMAINING_2'] = data.LIMIT_BAL - data.BILL_AMT2\n",
        "data['BAL_REMAINING_1'] = data.LIMIT_BAL - data.BILL_AMT1\n",
        "data"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "VhIhT-ZjC0ZR"
      },
      "source": [
        "Bining Balance Remaining"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "maMXL41KC0ZS"
      },
      "outputs": [],
      "source": [
        "# data['BAL_REMAINING_6_Bin'] = data['BAL_REMAINING_6'].apply(lambda x: True if x > 0 else False)\n",
        "# data['BAL_REMAINING_5_Bin'] = data['BAL_REMAINING_5'].apply(lambda x: True if x > 0 else False)\n",
        "# data['BAL_REMAINING_4_Bin'] = data['BAL_REMAINING_4'].apply(lambda x: True if x > 0 else False)\n",
        "# data['BAL_REMAINING_3_Bin'] = data['BAL_REMAINING_3'].apply(lambda x: True if x > 0 else False)\n",
        "# data['BAL_REMAINING_2_Bin'] = data['BAL_REMAINING_2'].apply(lambda x: True if x > 0 else False)\n",
        "# data['BAL_REMAINING_1_Bin'] = data['BAL_REMAINING_1'].apply(lambda x: True if x > 0 else False)\n",
        "# data\n",
        "\n",
        "# data.loc[data['BAL_REMAINING_6_Bin'] == False]"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "ssKbKfFwwbUV"
      },
      "source": [
        "*Binning*"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "Xhd1nQa9r1va"
      },
      "outputs": [],
      "source": [
        "#create feature that bins age into decade groupings\n",
        "data['AGE_GROUP'] = pd.cut(x=data['AGE'], bins=[20, 29, 39, 49, 59, 69, 79])"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "buh9jnO7r13K"
      },
      "outputs": [],
      "source": [
        "data['AGE_DECADE'] = pd.cut(x=data['AGE'], bins=[20, 29, 39, 49, 59, 69, 79], labels=['20s', '30s', '40s', '50s', '60s', '70s'])"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "bwo1jQTgzO78"
      },
      "outputs": [],
      "source": [
        "data = data.drop(['AGE_GROUP'], axis=1)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "HhQMUlXfzy2P",
        "outputId": "69f522bd-1c57-4a88-c30d-0f285937ccc1"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>LIMIT_BAL</th>\n",
              "      <th>SEX</th>\n",
              "      <th>EDUCATION</th>\n",
              "      <th>MARRIAGE</th>\n",
              "      <th>AGE</th>\n",
              "      <th>PAY_1</th>\n",
              "      <th>PAY_2</th>\n",
              "      <th>PAY_3</th>\n",
              "      <th>PAY_4</th>\n",
              "      <th>...</th>\n",
              "      <th>PAY_AMT6</th>\n",
              "      <th>DEFAULT</th>\n",
              "      <th>CLUSTER</th>\n",
              "      <th>BAL_REMAINING_6</th>\n",
              "      <th>BAL_REMAINING_5</th>\n",
              "      <th>BAL_REMAINING_4</th>\n",
              "      <th>BAL_REMAINING_3</th>\n",
              "      <th>BAL_REMAINING_2</th>\n",
              "      <th>BAL_REMAINING_1</th>\n",
              "      <th>AGE_DECADE</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>24</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>19311.0</td>\n",
              "      <td>16898.0</td>\n",
              "      <td>16087.0</td>\n",
              "      <td>20s</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>2</td>\n",
              "      <td>120000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>26</td>\n",
              "      <td>-1</td>\n",
              "      <td>2</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>2000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>116739.0</td>\n",
              "      <td>116545.0</td>\n",
              "      <td>116728.0</td>\n",
              "      <td>117318.0</td>\n",
              "      <td>118275.0</td>\n",
              "      <td>117318.0</td>\n",
              "      <td>20s</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3</td>\n",
              "      <td>90000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>34</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>5000.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>74451.0</td>\n",
              "      <td>75052.0</td>\n",
              "      <td>75669.0</td>\n",
              "      <td>76441.0</td>\n",
              "      <td>75973.0</td>\n",
              "      <td>60761.0</td>\n",
              "      <td>30s</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>4</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>37</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>20453.0</td>\n",
              "      <td>21041.0</td>\n",
              "      <td>21686.0</td>\n",
              "      <td>709.0</td>\n",
              "      <td>1767.0</td>\n",
              "      <td>3010.0</td>\n",
              "      <td>30s</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>5</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>57</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>679.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>30869.0</td>\n",
              "      <td>30854.0</td>\n",
              "      <td>29060.0</td>\n",
              "      <td>14165.0</td>\n",
              "      <td>44330.0</td>\n",
              "      <td>41383.0</td>\n",
              "      <td>50s</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29995</th>\n",
              "      <td>29996</td>\n",
              "      <td>220000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>1</td>\n",
              "      <td>39</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>204020.0</td>\n",
              "      <td>188763.0</td>\n",
              "      <td>131996.0</td>\n",
              "      <td>11635.0</td>\n",
              "      <td>27185.0</td>\n",
              "      <td>31052.0</td>\n",
              "      <td>30s</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29996</th>\n",
              "      <td>29997</td>\n",
              "      <td>150000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>2</td>\n",
              "      <td>43</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>150000.0</td>\n",
              "      <td>144810.0</td>\n",
              "      <td>141021.0</td>\n",
              "      <td>146498.0</td>\n",
              "      <td>148172.0</td>\n",
              "      <td>148317.0</td>\n",
              "      <td>40s</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29997</th>\n",
              "      <td>29998</td>\n",
              "      <td>30000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>37</td>\n",
              "      <td>4</td>\n",
              "      <td>3</td>\n",
              "      <td>2</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>3100.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>10643.0</td>\n",
              "      <td>9418.0</td>\n",
              "      <td>9122.0</td>\n",
              "      <td>27242.0</td>\n",
              "      <td>26644.0</td>\n",
              "      <td>26435.0</td>\n",
              "      <td>30s</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29998</th>\n",
              "      <td>29999</td>\n",
              "      <td>80000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>1</td>\n",
              "      <td>41</td>\n",
              "      <td>1</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1804.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>31056.0</td>\n",
              "      <td>68145.0</td>\n",
              "      <td>27226.0</td>\n",
              "      <td>3696.0</td>\n",
              "      <td>1621.0</td>\n",
              "      <td>81645.0</td>\n",
              "      <td>40s</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29999</th>\n",
              "      <td>30000</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>46</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>1000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>0</td>\n",
              "      <td>34687.0</td>\n",
              "      <td>17572.0</td>\n",
              "      <td>13465.0</td>\n",
              "      <td>236.0</td>\n",
              "      <td>1095.0</td>\n",
              "      <td>2071.0</td>\n",
              "      <td>40s</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>30000 rows  33 columns</p>\n",
              "</div>"
            ],
            "text/plain": [
              "          ID  LIMIT_BAL SEX EDUCATION MARRIAGE  AGE PAY_1 PAY_2 PAY_3 PAY_4  \\\n",
              "0          1    20000.0   2         2        1   24     2     2    -1    -1   \n",
              "1          2   120000.0   2         2        2   26    -1     2     0     0   \n",
              "2          3    90000.0   2         2        2   34     0     0     0     0   \n",
              "3          4    50000.0   2         2        1   37     0     0     0     0   \n",
              "4          5    50000.0   1         2        1   57    -1     0    -1     0   \n",
              "...      ...        ...  ..       ...      ...  ...   ...   ...   ...   ...   \n",
              "29995  29996   220000.0   1         3        1   39     0     0     0     0   \n",
              "29996  29997   150000.0   1         3        2   43    -1    -1    -1    -1   \n",
              "29997  29998    30000.0   1         2        2   37     4     3     2    -1   \n",
              "29998  29999    80000.0   1         3        1   41     1    -1     0     0   \n",
              "29999  30000    50000.0   1         2        1   46     0     0     0     0   \n",
              "\n",
              "       ... PAY_AMT6 DEFAULT  CLUSTER  BAL_REMAINING_6  BAL_REMAINING_5  \\\n",
              "0      ...      0.0       1        0          20000.0          20000.0   \n",
              "1      ...   2000.0       1        0         116739.0         116545.0   \n",
              "2      ...   5000.0       0        0          74451.0          75052.0   \n",
              "3      ...   1000.0       0        0          20453.0          21041.0   \n",
              "4      ...    679.0       0        0          30869.0          30854.0   \n",
              "...    ...      ...     ...      ...              ...              ...   \n",
              "29995  ...   1000.0       0        0         204020.0         188763.0   \n",
              "29996  ...      0.0       0        0         150000.0         144810.0   \n",
              "29997  ...   3100.0       1        0          10643.0           9418.0   \n",
              "29998  ...   1804.0       1        3          31056.0          68145.0   \n",
              "29999  ...   1000.0       1        0          34687.0          17572.0   \n",
              "\n",
              "       BAL_REMAINING_4  BAL_REMAINING_3  BAL_REMAINING_2  BAL_REMAINING_1  \\\n",
              "0              20000.0          19311.0          16898.0          16087.0   \n",
              "1             116728.0         117318.0         118275.0         117318.0   \n",
              "2              75669.0          76441.0          75973.0          60761.0   \n",
              "3              21686.0            709.0           1767.0           3010.0   \n",
              "4              29060.0          14165.0          44330.0          41383.0   \n",
              "...                ...              ...              ...              ...   \n",
              "29995         131996.0          11635.0          27185.0          31052.0   \n",
              "29996         141021.0         146498.0         148172.0         148317.0   \n",
              "29997           9122.0          27242.0          26644.0          26435.0   \n",
              "29998          27226.0           3696.0           1621.0          81645.0   \n",
              "29999          13465.0            236.0           1095.0           2071.0   \n",
              "\n",
              "       AGE_DECADE  \n",
              "0             20s  \n",
              "1             20s  \n",
              "2             30s  \n",
              "3             30s  \n",
              "4             50s  \n",
              "...           ...  \n",
              "29995         30s  \n",
              "29996         40s  \n",
              "29997         30s  \n",
              "29998         40s  \n",
              "29999         40s  \n",
              "\n",
              "[30000 rows x 33 columns]"
            ]
          },
          "execution_count": 37,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "data"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "3Qvvt4PiC0ZT"
      },
      "source": [
        "Log Transform"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "S0W-nLElC0ZT"
      },
      "outputs": [],
      "source": [
        "data['LIMIT_BAL_Log'] = np.log(data['LIMIT_BAL']) "
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "c2cEv11_C0ZT",
        "outputId": "04e28bbd-2e26-4e3d-9689-8d17d3b82297"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "0         9.903488\n",
              "1        11.695247\n",
              "2        11.407565\n",
              "3        10.819778\n",
              "4        10.819778\n",
              "           ...    \n",
              "29995    12.301383\n",
              "29996    11.918391\n",
              "29997    10.308953\n",
              "29998    11.289782\n",
              "29999    10.819778\n",
              "Name: LIMIT_BAL_Log, Length: 30000, dtype: float64"
            ]
          },
          "execution_count": 39,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "data['LIMIT_BAL_Log']"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "36plbf7dC0ZU"
      },
      "outputs": [],
      "source": [
        "# data['AGE Log'] = np.log(data['AGE']) "
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "bD1QQXn0C0ZU"
      },
      "outputs": [],
      "source": [
        "# data['AGE Log']"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "s15sBFWiymlY",
        "outputId": "b7166b98-36ea-4b51-ad71-92d00aa53ed8"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "<class 'pandas.core.frame.DataFrame'>\n",
            "RangeIndex: 30000 entries, 0 to 29999\n",
            "Data columns (total 34 columns):\n",
            " #   Column           Non-Null Count  Dtype   \n",
            "---  ------           --------------  -----   \n",
            " 0   ID               30000 non-null  int64   \n",
            " 1   LIMIT_BAL        30000 non-null  float64 \n",
            " 2   SEX              30000 non-null  category\n",
            " 3   EDUCATION        30000 non-null  category\n",
            " 4   MARRIAGE         30000 non-null  category\n",
            " 5   AGE              30000 non-null  int64   \n",
            " 6   PAY_1            30000 non-null  category\n",
            " 7   PAY_2            30000 non-null  category\n",
            " 8   PAY_3            30000 non-null  category\n",
            " 9   PAY_4            30000 non-null  category\n",
            " 10  PAY_5            30000 non-null  category\n",
            " 11  PAY_6            30000 non-null  category\n",
            " 12  BILL_AMT1        30000 non-null  float64 \n",
            " 13  BILL_AMT2        30000 non-null  float64 \n",
            " 14  BILL_AMT3        30000 non-null  float64 \n",
            " 15  BILL_AMT4        30000 non-null  float64 \n",
            " 16  BILL_AMT5        30000 non-null  float64 \n",
            " 17  BILL_AMT6        30000 non-null  float64 \n",
            " 18  PAY_AMT1         30000 non-null  float64 \n",
            " 19  PAY_AMT2         30000 non-null  float64 \n",
            " 20  PAY_AMT3         30000 non-null  float64 \n",
            " 21  PAY_AMT4         30000 non-null  float64 \n",
            " 22  PAY_AMT5         30000 non-null  float64 \n",
            " 23  PAY_AMT6         30000 non-null  float64 \n",
            " 24  DEFAULT          30000 non-null  category\n",
            " 25  CLUSTER          30000 non-null  category\n",
            " 26  BAL_REMAINING_6  30000 non-null  float64 \n",
            " 27  BAL_REMAINING_5  30000 non-null  float64 \n",
            " 28  BAL_REMAINING_4  30000 non-null  float64 \n",
            " 29  BAL_REMAINING_3  30000 non-null  float64 \n",
            " 30  BAL_REMAINING_2  30000 non-null  float64 \n",
            " 31  BAL_REMAINING_1  30000 non-null  float64 \n",
            " 32  AGE_DECADE       30000 non-null  category\n",
            " 33  LIMIT_BAL_Log    30000 non-null  float64 \n",
            "dtypes: category(12), float64(20), int64(2)\n",
            "memory usage: 5.4 MB\n"
          ]
        }
      ],
      "source": [
        "data.info()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "r5P83z0V7LBu",
        "outputId": "60d8d239-9209-4454-c707-c176424ef031"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "10000.0\n",
            "1000000.0\n"
          ]
        }
      ],
      "source": [
        "#create feature that bins LIMIT_BAL into size groupings\n",
        "min_value = data['LIMIT_BAL'].min()\n",
        "max_value = data['LIMIT_BAL'].max()\n",
        "print(min_value)\n",
        "print(max_value)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "q0uS2KZV78g9",
        "outputId": "810ab885-ab43-492f-9e15-a07d83b7977e"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "array([  10000.,  340000.,  670000., 1000000.])"
            ]
          },
          "execution_count": 44,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "bins = np.linspace(min_value,max_value,4)\n",
        "bins"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "iuEbx7zm7_JR"
      },
      "outputs": [],
      "source": [
        "labels = ['small', 'medium', 'large']"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "mN-ZFJOH8CII"
      },
      "outputs": [],
      "source": [
        "data['LIMIT_BAL_GROUPS'] = pd.cut(data['LIMIT_BAL'], bins=bins, labels=labels, include_lowest=True)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "C9SvGrdl8IiF",
        "outputId": "1a8fed00-8baa-467a-a023-86bc44819c08"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ID</th>\n",
              "      <th>LIMIT_BAL</th>\n",
              "      <th>SEX</th>\n",
              "      <th>EDUCATION</th>\n",
              "      <th>MARRIAGE</th>\n",
              "      <th>AGE</th>\n",
              "      <th>PAY_1</th>\n",
              "      <th>PAY_2</th>\n",
              "      <th>PAY_3</th>\n",
              "      <th>PAY_4</th>\n",
              "      <th>...</th>\n",
              "      <th>CLUSTER</th>\n",
              "      <th>BAL_REMAINING_6</th>\n",
              "      <th>BAL_REMAINING_5</th>\n",
              "      <th>BAL_REMAINING_4</th>\n",
              "      <th>BAL_REMAINING_3</th>\n",
              "      <th>BAL_REMAINING_2</th>\n",
              "      <th>BAL_REMAINING_1</th>\n",
              "      <th>AGE_DECADE</th>\n",
              "      <th>LIMIT_BAL_Log</th>\n",
              "      <th>LIMIT_BAL_GROUPS</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>24</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>20000.0</td>\n",
              "      <td>19311.0</td>\n",
              "      <td>16898.0</td>\n",
              "      <td>16087.0</td>\n",
              "      <td>20s</td>\n",
              "      <td>9.903488</td>\n",
              "      <td>small</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>2</td>\n",
              "      <td>120000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>26</td>\n",
              "      <td>-1</td>\n",
              "      <td>2</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>116739.0</td>\n",
              "      <td>116545.0</td>\n",
              "      <td>116728.0</td>\n",
              "      <td>117318.0</td>\n",
              "      <td>118275.0</td>\n",
              "      <td>117318.0</td>\n",
              "      <td>20s</td>\n",
              "      <td>11.695247</td>\n",
              "      <td>small</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3</td>\n",
              "      <td>90000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>34</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>74451.0</td>\n",
              "      <td>75052.0</td>\n",
              "      <td>75669.0</td>\n",
              "      <td>76441.0</td>\n",
              "      <td>75973.0</td>\n",
              "      <td>60761.0</td>\n",
              "      <td>30s</td>\n",
              "      <td>11.407565</td>\n",
              "      <td>small</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>4</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>37</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>20453.0</td>\n",
              "      <td>21041.0</td>\n",
              "      <td>21686.0</td>\n",
              "      <td>709.0</td>\n",
              "      <td>1767.0</td>\n",
              "      <td>3010.0</td>\n",
              "      <td>30s</td>\n",
              "      <td>10.819778</td>\n",
              "      <td>small</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>5</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>57</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>30869.0</td>\n",
              "      <td>30854.0</td>\n",
              "      <td>29060.0</td>\n",
              "      <td>14165.0</td>\n",
              "      <td>44330.0</td>\n",
              "      <td>41383.0</td>\n",
              "      <td>50s</td>\n",
              "      <td>10.819778</td>\n",
              "      <td>small</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29995</th>\n",
              "      <td>29996</td>\n",
              "      <td>220000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>1</td>\n",
              "      <td>39</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>204020.0</td>\n",
              "      <td>188763.0</td>\n",
              "      <td>131996.0</td>\n",
              "      <td>11635.0</td>\n",
              "      <td>27185.0</td>\n",
              "      <td>31052.0</td>\n",
              "      <td>30s</td>\n",
              "      <td>12.301383</td>\n",
              "      <td>small</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29996</th>\n",
              "      <td>29997</td>\n",
              "      <td>150000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>2</td>\n",
              "      <td>43</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>150000.0</td>\n",
              "      <td>144810.0</td>\n",
              "      <td>141021.0</td>\n",
              "      <td>146498.0</td>\n",
              "      <td>148172.0</td>\n",
              "      <td>148317.0</td>\n",
              "      <td>40s</td>\n",
              "      <td>11.918391</td>\n",
              "      <td>small</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29997</th>\n",
              "      <td>29998</td>\n",
              "      <td>30000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "      <td>37</td>\n",
              "      <td>4</td>\n",
              "      <td>3</td>\n",
              "      <td>2</td>\n",
              "      <td>-1</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>10643.0</td>\n",
              "      <td>9418.0</td>\n",
              "      <td>9122.0</td>\n",
              "      <td>27242.0</td>\n",
              "      <td>26644.0</td>\n",
              "      <td>26435.0</td>\n",
              "      <td>30s</td>\n",
              "      <td>10.308953</td>\n",
              "      <td>small</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29998</th>\n",
              "      <td>29999</td>\n",
              "      <td>80000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>3</td>\n",
              "      <td>1</td>\n",
              "      <td>41</td>\n",
              "      <td>1</td>\n",
              "      <td>-1</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>3</td>\n",
              "      <td>31056.0</td>\n",
              "      <td>68145.0</td>\n",
              "      <td>27226.0</td>\n",
              "      <td>3696.0</td>\n",
              "      <td>1621.0</td>\n",
              "      <td>81645.0</td>\n",
              "      <td>40s</td>\n",
              "      <td>11.289782</td>\n",
              "      <td>small</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>29999</th>\n",
              "      <td>30000</td>\n",
              "      <td>50000.0</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1</td>\n",
              "      <td>46</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>0</td>\n",
              "      <td>...</td>\n",
              "      <td>0</td>\n",
              "      <td>34687.0</td>\n",
              "      <td>17572.0</td>\n",
              "      <td>13465.0</td>\n",
              "      <td>236.0</td>\n",
              "      <td>1095.0</td>\n",
              "      <td>2071.0</td>\n",
              "      <td>40s</td>\n",
              "      <td>10.819778</td>\n",
              "      <td>small</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>30000 rows  35 columns</p>\n",
              "</div>"
            ],
            "text/plain": [
              "          ID  LIMIT_BAL SEX EDUCATION MARRIAGE  AGE PAY_1 PAY_2 PAY_3 PAY_4  \\\n",
              "0          1    20000.0   2         2        1   24     2     2    -1    -1   \n",
              "1          2   120000.0   2         2        2   26    -1     2     0     0   \n",
              "2          3    90000.0   2         2        2   34     0     0     0     0   \n",
              "3          4    50000.0   2         2        1   37     0     0     0     0   \n",
              "4          5    50000.0   1         2        1   57    -1     0    -1     0   \n",
              "...      ...        ...  ..       ...      ...  ...   ...   ...   ...   ...   \n",
              "29995  29996   220000.0   1         3        1   39     0     0     0     0   \n",
              "29996  29997   150000.0   1         3        2   43    -1    -1    -1    -1   \n",
              "29997  29998    30000.0   1         2        2   37     4     3     2    -1   \n",
              "29998  29999    80000.0   1         3        1   41     1    -1     0     0   \n",
              "29999  30000    50000.0   1         2        1   46     0     0     0     0   \n",
              "\n",
              "       ... CLUSTER BAL_REMAINING_6  BAL_REMAINING_5  BAL_REMAINING_4  \\\n",
              "0      ...       0         20000.0          20000.0          20000.0   \n",
              "1      ...       0        116739.0         116545.0         116728.0   \n",
              "2      ...       0         74451.0          75052.0          75669.0   \n",
              "3      ...       0         20453.0          21041.0          21686.0   \n",
              "4      ...       0         30869.0          30854.0          29060.0   \n",
              "...    ...     ...             ...              ...              ...   \n",
              "29995  ...       0        204020.0         188763.0         131996.0   \n",
              "29996  ...       0        150000.0         144810.0         141021.0   \n",
              "29997  ...       0         10643.0           9418.0           9122.0   \n",
              "29998  ...       3         31056.0          68145.0          27226.0   \n",
              "29999  ...       0         34687.0          17572.0          13465.0   \n",
              "\n",
              "       BAL_REMAINING_3  BAL_REMAINING_2  BAL_REMAINING_1  AGE_DECADE  \\\n",
              "0              19311.0          16898.0          16087.0         20s   \n",
              "1             117318.0         118275.0         117318.0         20s   \n",
              "2              76441.0          75973.0          60761.0         30s   \n",
              "3                709.0           1767.0           3010.0         30s   \n",
              "4              14165.0          44330.0          41383.0         50s   \n",
              "...                ...              ...              ...         ...   \n",
              "29995          11635.0          27185.0          31052.0         30s   \n",
              "29996         146498.0         148172.0         148317.0         40s   \n",
              "29997          27242.0          26644.0          26435.0         30s   \n",
              "29998           3696.0           1621.0          81645.0         40s   \n",
              "29999            236.0           1095.0           2071.0         40s   \n",
              "\n",
              "       LIMIT_BAL_Log  LIMIT_BAL_GROUPS  \n",
              "0           9.903488             small  \n",
              "1          11.695247             small  \n",
              "2          11.407565             small  \n",
              "3          10.819778             small  \n",
              "4          10.819778             small  \n",
              "...              ...               ...  \n",
              "29995      12.301383             small  \n",
              "29996      11.918391             small  \n",
              "29997      10.308953             small  \n",
              "29998      11.289782             small  \n",
              "29999      10.819778             small  \n",
              "\n",
              "[30000 rows x 35 columns]"
            ]
          },
          "execution_count": 47,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "data"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "0VBxLFh58Kk1",
        "outputId": "9ca644c0-07d4-417f-ceb1-bc23d40930f7"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "<class 'pandas.core.frame.DataFrame'>\n",
            "RangeIndex: 30000 entries, 0 to 29999\n",
            "Data columns (total 35 columns):\n",
            " #   Column            Non-Null Count  Dtype   \n",
            "---  ------            --------------  -----   \n",
            " 0   ID                30000 non-null  int64   \n",
            " 1   LIMIT_BAL         30000 non-null  float64 \n",
            " 2   SEX               30000 non-null  category\n",
            " 3   EDUCATION         30000 non-null  category\n",
            " 4   MARRIAGE          30000 non-null  category\n",
            " 5   AGE               30000 non-null  int64   \n",
            " 6   PAY_1             30000 non-null  category\n",
            " 7   PAY_2             30000 non-null  category\n",
            " 8   PAY_3             30000 non-null  category\n",
            " 9   PAY_4             30000 non-null  category\n",
            " 10  PAY_5             30000 non-null  category\n",
            " 11  PAY_6             30000 non-null  category\n",
            " 12  BILL_AMT1         30000 non-null  float64 \n",
            " 13  BILL_AMT2         30000 non-null  float64 \n",
            " 14  BILL_AMT3         30000 non-null  float64 \n",
            " 15  BILL_AMT4         30000 non-null  float64 \n",
            " 16  BILL_AMT5         30000 non-null  float64 \n",
            " 17  BILL_AMT6         30000 non-null  float64 \n",
            " 18  PAY_AMT1          30000 non-null  float64 \n",
            " 19  PAY_AMT2          30000 non-null  float64 \n",
            " 20  PAY_AMT3          30000 non-null  float64 \n",
            " 21  PAY_AMT4          30000 non-null  float64 \n",
            " 22  PAY_AMT5          30000 non-null  float64 \n",
            " 23  PAY_AMT6          30000 non-null  float64 \n",
            " 24  DEFAULT           30000 non-null  category\n",
            " 25  CLUSTER           30000 non-null  category\n",
            " 26  BAL_REMAINING_6   30000 non-null  float64 \n",
            " 27  BAL_REMAINING_5   30000 non-null  float64 \n",
            " 28  BAL_REMAINING_4   30000 non-null  float64 \n",
            " 29  BAL_REMAINING_3   30000 non-null  float64 \n",
            " 30  BAL_REMAINING_2   30000 non-null  float64 \n",
            " 31  BAL_REMAINING_1   30000 non-null  float64 \n",
            " 32  AGE_DECADE        30000 non-null  category\n",
            " 33  LIMIT_BAL_Log     30000 non-null  float64 \n",
            " 34  LIMIT_BAL_GROUPS  30000 non-null  category\n",
            "dtypes: category(13), float64(20), int64(2)\n",
            "memory usage: 5.4 MB\n"
          ]
        }
      ],
      "source": [
        "data.info()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "4QzJ6c9XC0ZV"
      },
      "outputs": [],
      "source": [
        "data.to_excel('UCI_Credit_Card_Clean.xlsx', index = False)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "d-GacWXAQB1-"
      },
      "source": [
        "Modelling\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "18RrXva1QC6X"
      },
      "outputs": [],
      "source": [
        "from pycaret.classification import *\n",
        "s = setup(data, target = 'DEFAULT', session_id = 123, fix_imbalance = True,  feature_interaction=True) #target rebalanced with SMOTE and multiplication of features applied"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "wObv5Cg0Lh43"
      },
      "outputs": [],
      "source": [
        "model = create_model('lightgbm', fold=10)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "NxX4MR3SdQJ5"
      },
      "source": [
        "Hyperparameter tuning"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "0gYKDks1dNvY"
      },
      "outputs": [],
      "source": [
        "final_model = tune_model(model, optimize = 'AUC')"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "eAgd-5EUXQqj"
      },
      "source": [
        "Model performance "
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "UzUQhsEED250"
      },
      "outputs": [],
      "source": [
        "predict_model(final_model);"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "CLFFPwRcD-9u"
      },
      "source": [
        "Vizualizations "
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "n0Wv81BAEElU"
      },
      "outputs": [],
      "source": [
        "plot_model(final_model, plot = 'auc')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "T0yWEh2xEEsJ"
      },
      "outputs": [],
      "source": [
        "plot_model(final_model, plot = 'confusion_matrix')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "kBKi6RPhEEuX"
      },
      "outputs": [],
      "source": [
        "plot_model(final_model, plot = 'pr')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "kvSD1P7hEEwv"
      },
      "outputs": [],
      "source": [
        "plot_model(final_model, plot = 'feature')"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "K7srWrxUEbZg"
      },
      "source": [
        "Save pipeline "
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "b0ff8gAEEhBH"
      },
      "outputs": [],
      "source": [
        "save_model(final_model, 'pipeline')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "eMG-Hx3dEkBC"
      },
      "outputs": [],
      "source": [
        "loaded_pipeline = load_model('pipeline')\n",
        "print(loaded_pipeline)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "uyNNryWmEkEz"
      },
      "outputs": [],
      "source": [
        "# display as image\n",
        "from sklearn import set_config\n",
        "set_config(display = 'diagram')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "jTgbLdb4EkHx"
      },
      "outputs": [],
      "source": [
        "loaded_pipeline"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "nOyTT2WBjz3s"
      },
      "outputs": [],
      "source": [
        ""
      ]
    }
  ],
  "metadata": {
    "colab": {
      "collapsed_sections": [],
      "name": "MMA_823 Team Project.ipynb",
      "provenance": [],
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "MMA865",
      "language": "python",
      "name": "mma865"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.8.11"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}